const PASS = 'Ford@20132016';
let PRODUCTS = [];
let GALLERY  = [];
function login(){ const pw = document.getElementById('pass').value; if (pw === PASS){ document.getElementById('loginBox').style.display='none'; document.getElementById('panel').style.display='block'; loadProducts(); loadGallery(); } else { alert('Incorrect passphrase'); } }
async function loadProducts(){ const res = await fetch('products.json', { cache:'no-store' }); PRODUCTS = await res.json(); renderProducts(); }
function renderProducts(){ const body = document.getElementById('prodBody'); body.innerHTML=''; PRODUCTS.forEach((p,i)=>{ const tr=document.createElement('tr'); tr.appendChild(tdInput(p,'sku',i,'text','w-120')); tr.appendChild(tdInput(p,'name',i,'text','w-240')); tr.appendChild(tdInput(p,'price',i,'text','w-120')); tr.appendChild(tdInput(p,'amount',i,'number','w-120')); tr.appendChild(tdInput(p,'image',i,'text','w-320')); tr.appendChild(tdTextarea(p,'description',i)); const tdAct=document.createElement('td'); const del=document.createElement('button'); del.className='btn danger'; del.textContent='Delete'; del.onclick=()=>{ PRODUCTS.splice(i,1); renderProducts(); }; tdAct.appendChild(del); tr.appendChild(tdAct); body.appendChild(tr); }); }
function addProduct(){ PRODUCTS.push({ sku:'WA-XX', name:'New Product', price:'R0', amount:0, image:'assets/img/products/WA-XX.png', description:'' }); renderProducts(); }
function exportProducts(){ const blob=new Blob([JSON.stringify(PRODUCTS,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='products.json'; a.click(); URL.revokeObjectURL(a.href); alert('Downloaded products.json — commit this file to your repo.'); }
async function loadGallery(){ const res = await fetch('gallery.json', { cache:'no-store' }); GALLERY = await res.json(); renderGallery(); }
function renderGallery(){ const body=document.getElementById('galBody'); body.innerHTML=''; GALLERY.forEach((g,i)=>{ const tr=document.createElement('tr'); tr.appendChild(tdInput(g,'title',i,'text','w-240')); tr.appendChild(tdInput(g,'url',i,'text')); const tdPrev=document.createElement('td'); const img=document.createElement('img'); img.src=g.url; img.alt=g.title||'Image'; img.style.maxWidth='100px'; img.style.borderRadius='8px'; tdPrev.appendChild(img); tr.appendChild(tdPrev); const tdAct=document.createElement('td'); const del=document.createElement('button'); del.className='btn danger'; del.textContent='Delete'; del.onclick=()=>{ GALLERY.splice(i,1); renderGallery(); }; tdAct.appendChild(del); tr.appendChild(tdAct); body.appendChild(tr); }); }
function addGalleryItem(){ GALLERY.push({ title:'New Image', url:'assets/img/gallery/new-image.jpg' }); renderGallery(); }
function exportGallery(){ const blob=new Blob([JSON.stringify(GALLERY,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='gallery.json'; a.click(); URL.revokeObjectURL(a.href); alert('Downloaded gallery.json — commit this file to your repo.'); }
function tdInput(obj,key,index,type='text',extra=''){ const td=document.createElement('td'); const input=document.createElement('input'); input.type=type; input.value=obj[key]??''; if(extra) input.className=extra; input.oninput=()=>{ obj[key] = (type==='number'? Number(input.value): input.value); }; td.appendChild(input); return td; }
function tdTextarea(obj,key,index){ const td=document.createElement('td'); const ta=document.createElement('textarea'); ta.value=obj[key]??''; ta.rows=3; ta.oninput=()=>{ obj[key]=ta.value; }; td.appendChild(ta); return td; }
